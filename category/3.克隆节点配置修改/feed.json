{
    "version": "https://jsonfeed.org/version/1",
    "title": "余心所善，九死未悔！ • All posts by \"3.克隆节点配置修改\" category",
    "description": "",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2020/12/02/%E5%9C%A8%E7%BA%BF%E8%AF%BE%E7%A8%8B/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%BA%94%E7%94%A8/%E5%85%8B%E9%9A%86%E8%8A%82%E7%82%B9%E9%85%8D%E7%BD%AE%E4%BF%AE%E6%94%B9/",
            "url": "http://example.com/2020/12/02/%E5%9C%A8%E7%BA%BF%E8%AF%BE%E7%A8%8B/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B8%8E%E5%BA%94%E7%94%A8/%E5%85%8B%E9%9A%86%E8%8A%82%E7%82%B9%E9%85%8D%E7%BD%AE%E4%BF%AE%E6%94%B9/",
            "title": "5.克隆节点配置修改",
            "date_published": "2020-12-02T11:33:40.669Z",
            "content_html": "<h1 id=\"克隆节点配置修改\"><a class=\"anchor\" href=\"#克隆节点配置修改\">#</a> 克隆节点配置修改</h1>\n<p>在虚拟机 master 上安装及配置完成之后，将虚拟机 master 克隆两台虚拟机，得到 slave1 和 slave2，总共三台虚拟机。但是克隆出来的虚拟机需要一定的配置和修改才能使用。</p>\n<h2 id=\"克隆master虚拟机\"><a class=\"anchor\" href=\"#克隆master虚拟机\">#</a> 克隆 master 虚拟机</h2>\n<p>在克隆 master 虚拟机之前需要将<strong> master 虚拟关机</strong>后才能使用克隆功能</p>\n<ul>\n<li>（1）右键单击虚拟机 master，选择 “<strong>管理</strong>”→“<strong>克隆</strong>” 命令，来到欢迎使用克隆虚拟机向导的界面，直接单击下一步，如图 5-1、5-2、5-3 所示</li>\n</ul>\n<p class=\"gallery\" data-height=\"180\"><img data-src=\"https://s3.ax1x.com/2020/11/22/D8cISK.jpg\" alt=\"D8cISK.jpg\" title=\"图5-1 克隆\" /><br />\n<img data-src=\"https://s3.ax1x.com/2020/11/22/D8chJx.jpg\" alt=\"D8cISK.jpg\" title=\"图5-2 克隆欢迎界面\" /><br />\n<img data-src=\"https://s3.ax1x.com/2020/11/22/D8cRoR.jpg\" alt=\"D8cISK.jpg\" title=\"图5-3 克隆源\" /></p>\n<ul>\n<li>（2）选择 “<strong>创建完整克隆</strong>” 单击按钮并单击 “下一步” 按钮，如图 5-4 所示。</li>\n</ul>\n<p><img data-src=\"https://s3.ax1x.com/2020/11/22/D8cfF1.jpg\" alt=\"D8cISK.jpg\" title=\"图5-4 克隆类型\" /></p>\n<ul>\n<li>（3）设置新虚拟机的名称，新虚拟机名称为 slave1，并选择安装位置，单击完成，虚拟机开始克隆，最后单击 “关闭” 按钮，克隆虚拟机完成，如图 5-5、5-6 所示。</li>\n</ul>\n<p class=\"gallery\" data-height=\"180\"><img data-src=\"https://s3.ax1x.com/2020/11/22/D8cRoR.jpg\" alt=\"D8cISK.jpg\" title=\"图5-5 克隆源\" /><br />\n<img data-src=\"https://s3.ax1x.com/2020/11/22/D8c4W6.jpg\" alt=\"D8cISK.jpg\" title=\"图5-6 克隆完成\" /></p>\n<ul>\n<li>（4）重复 1-3 步骤可以得到 slave2 虚拟机。</li>\n</ul>\n<h2 id=\"克隆虚拟机配置\"><a class=\"anchor\" href=\"#克隆虚拟机配置\">#</a> 克隆虚拟机配置</h2>\n<p>克隆完成之后的虚拟机，slave1 和 slave2 都是不可以直接使用的，因为克隆的信息都是 master 的信息，需要修改之后才能使用，开启 slave1 虚拟机。</p>\n<p>（1）执行命令 “<strong>ifconfig -a</strong>”，查看 HWADDR，记录新虚拟机的网卡名和 HWADDR（不同的机器此值是不一样的），例如下面显示的<strong> eth1</strong> 和 HWaddr：00:0C:29:90:31:E2。</p>\n<p><figure class=\"highlight bash\"><figcaption><span>查看配置信息</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@master ~]<span class=\"comment\"># ifconfig -a</span></span><br><span class=\"line\">eth1      Link encap:Ethernet  HWaddr 00:0C:29:90:31:E2  </span><br><span class=\"line\">          inet addr:192.168.146.172  Bcast:192.168.146.255  Mask:255.255.255.0</span><br><span class=\"line\">          inet6 addr: fe80::20c:29ff:fe90:31e2/64 Scope:Link</span><br><span class=\"line\">          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1</span><br><span class=\"line\">          RX packets:40 errors:0 dropped:0 overruns:0 frame:0</span><br><span class=\"line\">          TX packets:40 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class=\"line\">          collisions:0 txqueuelen:1000 </span><br><span class=\"line\">          RX bytes:4844 (4.7 KiB)  TX bytes:5039 (4.9 KiB)</span><br><span class=\"line\"></span><br><span class=\"line\">lo        Link encap:Local Loopback  </span><br><span class=\"line\">          inet addr:127.0.0.1  Mask:255.0.0.0</span><br><span class=\"line\">          inet6 addr: ::1/128 Scope:Host</span><br><span class=\"line\">          UP LOOPBACK RUNNING  MTU:16436  Metric:1</span><br><span class=\"line\">          RX packets:0 errors:0 dropped:0 overruns:0 frame:0</span><br><span class=\"line\">          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class=\"line\">          collisions:0 txqueuelen:0 </span><br><span class=\"line\">          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure><br />\n（3）修改 /etc/sysconfig/network-scripts/ifcfg-eth0 文件，修改 DEVICE、HWADDR 和 IPADDR，并 service network restart 重启网络服务。<br />\n<figure class=\"highlight bash\"><figcaption><span>修改slave1配置信息</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@master ~]<span class=\"comment\"># vi /etc/sysconfig/network-scripts/ifcfg-eth0 </span></span><br><span class=\"line\">DEVICE=eth1   <span class=\"comment\">#修改成ifconfig -a显示的信息</span></span><br><span class=\"line\">HWADDR=00:0C:29:90:31:E2    <span class=\"comment\">#修改成ifconfig -a显示的信息</span></span><br><span class=\"line\">TYPE=Ethernet</span><br><span class=\"line\">UUID=f994c111-ad55-4c32-8178-6c6069d8818c</span><br><span class=\"line\">ONBOOT=yes</span><br><span class=\"line\">NM_CONTROLLED=yes</span><br><span class=\"line\">BOOTPROTO=static</span><br><span class=\"line\">IPADDR=192.168.146.172  <span class=\"comment\">#修改ip</span></span><br><span class=\"line\">NETMASK=255.255.255.0</span><br><span class=\"line\">GATEWAY=192.168.146.2</span><br><span class=\"line\">DNS1=192.168.146.2</span><br><span class=\"line\">[root@master ~]<span class=\"comment\"># service network restart</span></span><br><span class=\"line\">Shutting down interface eth0:                              [  OK  ]</span><br><span class=\"line\">Shutting down loopback interface:                          [  OK  ]</span><br><span class=\"line\">Bringing up loopback interface:                            [  OK  ]</span><br><span class=\"line\">Bringing up interface eth0:  Determining <span class=\"keyword\">if</span> ip address 192.168.146.172 is already <span class=\"keyword\">in</span> use <span class=\"keyword\">for</span> device eth1...</span><br><span class=\"line\">                                                           [  OK  ]</span><br></pre></td></tr></table></figure></p>\n<div class=\"note info\">\n<p>上述修改完成之后，同样的可以使用 xshell 连接 slave1 节点虚拟机。</p>\n</div>\n<p>（4）修改主机名，执行命令 “vi /etc/sysconfig/network”，修改的主机名为 “<strong>slave1</strong>”，重启机器，执行<strong> reboot</strong> 命令，验证 slave1 主机名是否配置成功。</p>\n<p><figure class=\"highlight bash\"><figcaption><span>主机名并测试</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@master ~]<span class=\"comment\"># vi /etc/sysconfig/network</span></span><br><span class=\"line\">NETWORKING=yes</span><br><span class=\"line\">HOSTNAME=slave1  <span class=\"comment\"># 将master修改成mster，并保存退出</span></span><br><span class=\"line\">[root@master ~]<span class=\"comment\"># reboot               #重新登录xshell</span></span><br><span class=\"line\">[root@slave1 ~]<span class=\"comment\">#                   # 主机名已经修改</span></span><br></pre></td></tr></table></figure></p>\n<p>（4）在 slave1 和 server2 中配置 NTP，同样修改 /etc/ntp.conf 文件，注释掉 server 开头的行，并添加:<br />\n<figure class=\"highlight bash\"><figcaption><span>修改/etc/ntp.conf文件</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@slave1 ~]<span class=\"comment\"># vi /etc/ntp.conf</span></span><br><span class=\"line\"><span class=\"comment\"># the administrative functions.</span></span><br><span class=\"line\">restrict 127.0.0.1</span><br><span class=\"line\">restrict -6 ::1</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Hosts on local network are less restricted.</span></span><br><span class=\"line\"><span class=\"comment\">#restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Use public servers from the pool.ntp.org project.</span></span><br><span class=\"line\"><span class=\"comment\"># Please consider joining the pool (http://www.pool.ntp.org/join.html).</span></span><br><span class=\"line\"><span class=\"comment\">#server 0.centos.pool.ntp.org iburst</span></span><br><span class=\"line\"><span class=\"comment\">#server 1.centos.pool.ntp.org iburst</span></span><br><span class=\"line\"><span class=\"comment\">#server 2.centos.pool.ntp.org iburst</span></span><br><span class=\"line\"><span class=\"comment\">#server 3.centos.pool.ntp.org iburst</span></span><br><span class=\"line\">server master</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#broadcast 192.168.1.255 autokey        # broadcast server</span></span><br><span class=\"line\"><span class=\"comment\">#broadcastclient                        # broadcast client</span></span><br><span class=\"line\"><span class=\"comment\">#broadcast 224.0.1.1 autokey            # multicast server</span></span><br><span class=\"line\"><span class=\"comment\">#multicastclient 224.0.1.1              # multicast client</span></span><br><span class=\"line\"><span class=\"comment\">#manycastserver 239.255.254.254         # manycast server</span></span><br><span class=\"line\"><span class=\"comment\">#manycastclient 239.255.254.254 autokey # manycast client</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Enable public key cryptography.</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p>（5）启动 NTP 服务。<br />\n①  在 slave1 和 slave2 上执行命令 “ntpdate master” 即可同步时间。<br />\n②  在 slave1 和 slave2 上执行 “service ntpd start &amp; chkconfig ntpd on” 即可启动并永久启动。NTP 服务。</p>\n<p><figure class=\"highlight bash\"><figcaption><span>永久性关闭防火墙</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@master ~]<span class=\"comment\"># ssh slave1</span></span><br><span class=\"line\">Last login: Mon Nov 23 02:18:41 2020 from 192.168.146.171</span><br><span class=\"line\">[root@slave1 ~]<span class=\"comment\"># ntpdate master</span></span><br><span class=\"line\">23 Nov 02:22:40 ntpdate[1396]: adjust time server 192.168.146.171 offset 0.488075 sec</span><br><span class=\"line\">[root@slave1 ~]<span class=\"comment\"># service ntpd start &amp; chkconfig ntpd on</span></span><br><span class=\"line\">[1] 1411</span><br><span class=\"line\">[root@slave1 ~]<span class=\"comment\"># Starting ntpd:                            [  OK  ]</span></span><br><span class=\"line\"></span><br><span class=\"line\">[1]+  Done                    service ntpd start</span><br><span class=\"line\">[root@slave1 ~]<span class=\"comment\"># exit</span></span><br><span class=\"line\"><span class=\"built_in\">logout</span></span><br><span class=\"line\">Connection to slave1 closed.</span><br><span class=\"line\">[root@master ~]<span class=\"comment\"># ssh slave2</span></span><br><span class=\"line\">Last login: Mon Nov 23 02:22:54 2020 from master</span><br><span class=\"line\">[root@slave2 ~]<span class=\"comment\"># ntpdate master</span></span><br><span class=\"line\">23 Nov 02:23:37 ntpdate[1329]: adjust time server 192.168.146.171 offset 0.497395 sec</span><br><span class=\"line\">[root@slave2 ~]<span class=\"comment\"># service ntpd start &amp; chkconfig ntpd on</span></span><br><span class=\"line\">[1] 1330</span><br><span class=\"line\">[root@slave2 ~]<span class=\"comment\"># Starting ntpd:                            [  OK  ]</span></span><br><span class=\"line\"></span><br><span class=\"line\">[1]+  Done                    service ntpd start</span><br><span class=\"line\">[root@slave2 ~]<span class=\"comment\"># exit</span></span><br><span class=\"line\"><span class=\"built_in\">logout</span></span><br><span class=\"line\">Connection to slave2 closed.</span><br><span class=\"line\">[root@master ~]<span class=\"comment\">#</span></span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>（6）查看个节点的时间：时间应该同步，非常接近</li>\n</ul>\n<p><figure class=\"highlight bash\"><figcaption><span>节点时间</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@master ~]<span class=\"comment\"># date</span></span><br><span class=\"line\">Mon Nov 23 02:32:52 CST 2020</span><br><span class=\"line\">[root@master ~]<span class=\"comment\"># ssh slave1</span></span><br><span class=\"line\">Last login: Mon Nov 23 02:23:11 2020 from master</span><br><span class=\"line\">[root@slave1 ~]<span class=\"comment\"># date</span></span><br><span class=\"line\">Mon Nov 23 02:32:57 CST 2020</span><br><span class=\"line\">[root@slave1 ~]<span class=\"comment\"># exit</span></span><br><span class=\"line\"><span class=\"built_in\">logout</span></span><br><span class=\"line\">Connection to slave1 closed.</span><br><span class=\"line\">[root@master ~]<span class=\"comment\"># ssh slave2</span></span><br><span class=\"line\">Last login: Sun Nov 22 18:29:36 2020 from 192.168.146.100</span><br><span class=\"line\">[root@slave2 ~]<span class=\"comment\"># date</span></span><br><span class=\"line\">Mon Nov 23 02:33:05 CST 2020</span><br><span class=\"line\">[root@slave2 ~]<span class=\"comment\"># exit</span></span><br><span class=\"line\"><span class=\"built_in\">logout</span></span><br><span class=\"line\">Connection to slave2 closed.</span><br><span class=\"line\">[root@master ~]<span class=\"comment\"># </span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n",
            "tags": [
                "大数据技术与应用",
                "Hadoop"
            ]
        }
    ]
}